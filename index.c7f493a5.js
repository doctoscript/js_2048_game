!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r=new(function(){function r(t){e(this,r),console.log(t),this.isGameOver=!1,this.score=0,this.hasMovedOnce=!1}var o,n,s;return o=r,(n=[{key:"moveLeft",value:function(){var e=this;if(!this.isGameOver){var t=this.getState();return document.querySelector("tbody").querySelectorAll("tr").forEach(function(t){var r=Array.from(t.querySelectorAll("td"));e.processLine(r)}),this.afterMoveActions(t),this.score}}},{key:"moveRight",value:function(){var e=this;if(!this.isGameOver){var t=this.getState();return document.querySelector("tbody").querySelectorAll("tr").forEach(function(t){var r=Array.from(t.querySelectorAll("td"));r=r.reverse(),e.processLine(r)}),this.afterMoveActions(t),this.score}}},{key:"moveUp",value:function(){var e=this,t=function(t){var r=[];o.forEach(function(e){r.push(e.querySelectorAll("td")[t])}),e.processLine(r)};if(!this.isGameOver){for(var r=this.getState(),o=document.querySelector("tbody").querySelectorAll("tr"),n=o[0].querySelectorAll("td").length,s=0;s<n;s++)t(s);return this.afterMoveActions(r),this.score}}},{key:"moveDown",value:function(){var e=this,t=function(t){var r=[];o.forEach(function(e){r.push(e.querySelectorAll("td")[t])}),r.reverse(),e.processLine(r)};if(!this.isGameOver){for(var r=this.getState(),o=document.querySelector("tbody").querySelectorAll("tr"),n=o[0].querySelectorAll("td").length,s=0;s<n;s++)t(s);return this.afterMoveActions(r),this.score}}},{key:"getScore",value:function(){document.querySelector(".game-score").textContent=this.score}},{key:"getState",value:function(){var e=[];return document.querySelectorAll("tbody tr").forEach(function(t){var r=[];t.querySelectorAll("td").forEach(function(e){var t=parseInt(e.textContent.trim());r.push(isNaN(t)?0:t)}),e.push(r)}),e}},{key:"getStatus",value:function(){var e=this.getState(),t=e.some(function(e){return e.includes(0)}),r=e.some(function(e){return e.includes(2048)});return t||this.canMerge(e)?r?(this.isGameOver=!0,document.querySelector(".message-win").classList.remove("hidden"),"win"):"playing":(this.isGameOver=!0,document.querySelector(".message-lose").classList.remove("hidden"),"lose")}},{key:"start",value:function(){this.isGameOver=!1,document.querySelector(".message-start").classList.add("hidden");var e=0;this.getState().forEach(function(t){t.forEach(function(t){0!==t&&e++})});for(var t=0;t<2-e;t++)this.generateCube();this.getScore()}},{key:"restart",value:function(){this.isGameOver=!1,this.hasMovedOnce=!1;var e=document.querySelector(".button");e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start",document.querySelector(".message-start").classList.remove("hidden"),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),this.score=0,document.querySelectorAll("tbody tr").forEach(function(e){e.querySelectorAll("td").forEach(function(e){e.textContent="",e.classList.forEach(function(t){t.startsWith("field-cell--")&&e.classList.remove(t)})})}),this.getScore()}},{key:"extractValues",value:function(e){var t=[];return e.forEach(function(e){var r=e.textContent.trim();""!==r&&t.push(r)}),t}},{key:"updateCells",value:function(e,t){e.forEach(function(e,r){e.classList.forEach(function(t){t.startsWith("field-cell--")&&e.classList.remove(t)}),t[r]?(e.classList.add("field-cell--".concat(t[r])),e.textContent=t[r]):e.textContent=""})}},{key:"processLine",value:function(e){var t=this.extractValues(e);this.mergeCubes(t),this.updateCells(e,t)}},{key:"afterMoveActions",value:function(e){var t=this.getState();this.areStatesEqual(e,t)||(this.generateCube(),this.getStatus(),this.markFirstMove())}},{key:"mergeCubes",value:function(e){for(var t=0;t<e.length;t++)e[t]===e[t+1]&&(e[t]*=2,this.score+=e[t],e.splice(t+1,1));return e}},{key:"generateCube",value:function(){var e=document.querySelector("tbody").querySelectorAll("tr"),t=e[Math.floor(Math.random()*e.length)].querySelectorAll("td"),r=t[Math.floor(Math.random()*t.length)];if(""===r.textContent.trim()){var o=Math.random()<.9?2:4;r.classList.add("field-cell--".concat(o)),r.textContent=o}else this.generateCube()}},{key:"canMerge",value:function(e){for(var t=0;t<4;t++)for(var r=0;r<4;r++){var o=e[t][r];if(r<3&&o===e[t][r+1])return!0;if(t<3&&o===e[t+1][r])return!0}return!1}},{key:"areStatesEqual",value:function(e,t){for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++)if(e[r][o]!==t[r][o])return!1;return!0}},{key:"markFirstMove",value:function(){if(!this.hasMovedOnce){var e=document.querySelector(".button");e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart",this.hasMovedOnce=!0}}}])&&t(o.prototype,n),s&&t(o,s),r}()),o=document.querySelector(".button");o.addEventListener("click",function(){o.classList.contains("start")?r.start():o.classList.contains("restart")&&r.restart()}),document.addEventListener("keydown",function(e){switch(e.key){case"ArrowLeft":r.moveLeft(),r.getScore();break;case"ArrowRight":r.moveRight(),r.getScore();break;case"ArrowUp":r.moveUp(),r.getScore();break;case"ArrowDown":r.moveDown(),r.getScore()}})}();
//# sourceMappingURL=index.c7f493a5.js.map
