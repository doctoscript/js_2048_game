{"mappings":"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","sources":["src/scripts/main.js","src/modules/Game.class.js"],"sourcesContent":["'use strict';\nimport '../styles/main.scss';\n\n// Uncomment the next lines to use your game instance in the browser\n// const Game = require('../modules/Game.class');\n// const game = new Game();\nconst Game = require('../modules/Game.class');\nconst game = new Game();\n\n// Write your code here\nconst mainButton = document.querySelector('.button');\n\nmainButton.addEventListener('click', () => {\n  if (mainButton.classList.contains('start')) {\n    game.start();\n  } else if (mainButton.classList.contains('restart')) {\n    game.restart();\n  }\n});\n\ndocument.addEventListener('keydown', (e) => {\n  switch (e.key) {\n    case 'ArrowLeft':\n      game.moveLeft();\n      game.getScore();\n      break;\n    case 'ArrowRight':\n      game.moveRight();\n      game.getScore();\n      break;\n    case 'ArrowUp':\n      game.moveUp();\n      game.getScore();\n      break;\n    case 'ArrowDown':\n      game.moveDown();\n      game.getScore();\n      break;\n  }\n});\n","'use strict';\n/**\n * This class represents the game.\n * Now it has a basic structure, that is needed for testing.\n * Feel free to add more props and methods if needed.\n */\nclass Game {\n  /**\n   * Creates a new game instance.\n   *\n   * @param {number[][]} initialState\n   * The initial state of the board.\n   * @default\n   * [[0, 0, 0, 0],\n   *  [0, 0, 0, 0],\n   *  [0, 0, 0, 0],\n   *  [0, 0, 0, 0]]\n   *\n   * If passed, the board will be initialized with the provided\n   * initial state.\n   */\n  constructor(initialState) {\n    // eslint-disable-next-line no-console\n    console.log(initialState);\n    this.isGameOver = false;\n    this.score = 0;\n    this.hasMovedOnce = false;\n  }\n\n  moveLeft() {\n    if (this.isGameOver) {\n      return;\n    }\n\n    const prevState = this.getState();\n\n    const tbody = document.querySelector('tbody');\n    const rows = tbody.querySelectorAll('tr');\n\n    rows.forEach((row) => {\n      const cells = Array.from(row.querySelectorAll('td'));\n\n      this.processLine(cells);\n    });\n\n    this.afterMoveActions(prevState);\n\n    return this.score;\n  }\n\n  moveRight() {\n    if (this.isGameOver) {\n      return;\n    }\n\n    const prevState = this.getState();\n\n    const tbody = document.querySelector('tbody');\n    const rows = tbody.querySelectorAll('tr');\n\n    rows.forEach((row) => {\n      let cells = Array.from(row.querySelectorAll('td'));\n\n      cells = cells.reverse();\n      this.processLine(cells);\n    });\n\n    this.afterMoveActions(prevState);\n\n    return this.score;\n  }\n\n  moveUp() {\n    if (this.isGameOver) {\n      return;\n    }\n\n    const prevState = this.getState();\n\n    const tbody = document.querySelector('tbody');\n    const rows = tbody.querySelectorAll('tr');\n    const colsNum = rows[0].querySelectorAll('td').length;\n\n    for (let col = 0; col < colsNum; col++) {\n      const cells = [];\n\n      rows.forEach((row) => {\n        cells.push(row.querySelectorAll('td')[col]);\n      });\n      this.processLine(cells);\n    }\n\n    this.afterMoveActions(prevState);\n\n    return this.score;\n  }\n\n  moveDown() {\n    if (this.isGameOver) {\n      return;\n    }\n\n    const prevState = this.getState();\n\n    const tbody = document.querySelector('tbody');\n    const rows = tbody.querySelectorAll('tr');\n    const colsNum = rows[0].querySelectorAll('td').length;\n\n    for (let col = 0; col < colsNum; col++) {\n      const cells = [];\n\n      rows.forEach((row) => {\n        cells.push(row.querySelectorAll('td')[col]);\n      });\n      cells.reverse();\n      this.processLine(cells);\n    }\n\n    this.afterMoveActions(prevState);\n\n    return this.score;\n  }\n\n  /**\n   * @returns {number}\n   */\n  getScore() {\n    const score = document.querySelector('.game-score');\n\n    score.textContent = this.score;\n  }\n\n  /**\n   * @returns {number[][]}\n   */\n  getState() {\n    const state = [];\n    const rows = document.querySelectorAll('tbody tr');\n\n    rows.forEach((row) => {\n      const rowState = [];\n      const cells = row.querySelectorAll('td');\n\n      cells.forEach((cell) => {\n        const value = parseInt(cell.textContent.trim());\n\n        rowState.push(isNaN(value) ? 0 : value);\n      });\n\n      state.push(rowState);\n    });\n\n    return state;\n  }\n\n  /**\n   * Returns the current game status.\n@@ -50,19 +164,234 @@ class Game {\n   * `win` - the game is won;\n   * `lose` - the game is lost\n   */\n  getStatus() {\n    const state = this.getState();\n\n    const hasEmpty = state.some((row) => row.includes(0));\n\n    const isWin = state.some((row) => row.includes(2048));\n\n    if (!hasEmpty && !this.canMerge(state)) {\n      this.isGameOver = true;\n\n      const lose = document.querySelector('.message-lose');\n\n      lose.classList.remove('hidden');\n\n      return 'lose';\n    }\n\n    if (isWin) {\n      this.isGameOver = true;\n\n      const win = document.querySelector('.message-win');\n\n      win.classList.remove('hidden');\n\n      return 'win';\n    }\n\n    return 'playing';\n  }\n\n  /**\n   * Starts the game.\n   */\n  start() {\n    this.isGameOver = false;\n\n    const message = document.querySelector('.message-start');\n\n    message.classList.add('hidden');\n\n    let count = 0;\n    const values = this.getState();\n\n    values.forEach((row) => {\n      row.forEach((cell) => {\n        if (cell !== 0) {\n          count++;\n        }\n      });\n    });\n\n    for (let i = 0; i < 2 - count; i++) {\n      this.generateCube();\n    }\n\n    this.getScore();\n  }\n\n  /**\n   * Resets the game.\n   */\n  restart() {\n    this.isGameOver = false;\n    this.hasMovedOnce = false;\n\n    const mainButton = document.querySelector('.button');\n\n    mainButton.classList.remove('restart');\n    mainButton.classList.add('start');\n\n    mainButton.textContent = 'Start';\n\n    const message = document.querySelector('.message-start');\n\n    message.classList.remove('hidden');\n\n    const messageLose = document.querySelector('.message-lose');\n\n    messageLose.classList.add('hidden');\n\n    const messageWin = document.querySelector('.message-win');\n\n    messageWin.classList.add('hidden');\n\n    this.score = 0;\n\n    const rows = document.querySelectorAll('tbody tr');\n\n    rows.forEach((row) => {\n      row.querySelectorAll('td').forEach((col) => {\n        col.textContent = '';\n\n        col.classList.forEach((className) => {\n          if (className.startsWith('field-cell--')) {\n            col.classList.remove(className);\n          }\n        });\n      });\n    });\n\n    this.getScore();\n  }\n\n  extractValues(cells) {\n    const values = [];\n\n    cells.forEach((cell) => {\n      const value = cell.textContent.trim();\n\n      if (value !== '') {\n        values.push(value);\n      }\n    });\n\n    return values;\n  }\n\n  updateCells(cells, values) {\n    cells.forEach((cell, i) => {\n      cell.classList.forEach((className) => {\n        if (className.startsWith('field-cell--')) {\n          cell.classList.remove(className);\n        }\n      });\n\n      if (values[i]) {\n        cell.classList.add(`field-cell--${values[i]}`);\n        cell.textContent = values[i];\n      } else {\n        cell.textContent = '';\n      }\n    });\n  }\n\n  processLine(cells) {\n    const values = this.extractValues(cells);\n\n    this.mergeCubes(values);\n    this.updateCells(cells, values);\n  }\n\n  afterMoveActions(prevState) {\n    const newState = this.getState();\n    const hasChanged = this.areStatesEqual(prevState, newState);\n\n    if (!hasChanged) {\n      this.generateCube();\n      this.getStatus();\n      this.markFirstMove();\n    }\n  }\n\n  mergeCubes(values) {\n    for (let i = 0; i < values.length; i++) {\n      if (values[i] === values[i + 1]) {\n        values[i] *= 2;\n        this.score += values[i];\n        values.splice(i + 1, 1);\n      }\n    }\n\n    return values;\n  }\n\n  generateCube() {\n    const tbody = document.querySelector('tbody');\n    const rows = tbody.querySelectorAll('tr');\n\n    const randomRowIndex = Math.floor(Math.random() * rows.length);\n    const randomRow = rows[randomRowIndex];\n\n    const columns = randomRow.querySelectorAll('td');\n\n    const randomColumnIndex = Math.floor(Math.random() * columns.length);\n    const randomColumn = columns[randomColumnIndex];\n\n    if (randomColumn.textContent.trim() !== '') {\n      this.generateCube();\n\n      return;\n    }\n\n    const value = Math.random() < 0.9 ? 2 : 4;\n\n    // Add your own methods here\n    randomColumn.classList.add(`field-cell--${value}`);\n    randomColumn.textContent = value;\n  }\n\n  canMerge(state) {\n    for (let row = 0; row < 4; row++) {\n      for (let col = 0; col < 4; col++) {\n        const current = state[row][col];\n\n        if (col < 3 && current === state[row][col + 1]) {\n          return true;\n        }\n\n        if (row < 3 && current === state[row + 1][col]) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  areStatesEqual(state1, state2) {\n    for (let row = 0; row < state1.length; row++) {\n      for (let col = 0; col < state1[row].length; col++) {\n        if (state1[row][col] !== state2[row][col]) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  markFirstMove() {\n    if (!this.hasMovedOnce) {\n      const mainButton = document.querySelector('.button');\n\n      mainButton.classList.remove('start');\n      mainButton.classList.add('restart');\n\n      mainButton.textContent = 'Restart';\n      this.hasMovedOnce = true;\n    }\n  }\n}\n\nmodule.exports = Game;\n"],"names":["$09e991522ca7e64e$var$game","constructor","initialState","console","log","this","isGameOver","score","hasMovedOnce","moveLeft","prevState","getState","document","querySelector","querySelectorAll","forEach","row","cells","Array","from","processLine","afterMoveActions","moveRight","reverse","moveUp","rows","colsNum","length","col","push","moveDown","getScore","textContent","state","rowState","cell","value","parseInt","trim","isNaN","getStatus","hasEmpty","some","includes","isWin","canMerge","classList","remove","start","add","count","i","generateCube","restart","mainButton","className","startsWith","extractValues","values","updateCells","mergeCubes","newState","areStatesEqual","markFirstMove","splice","columns","Math","floor","random","randomColumn","current","state1","state2","$09e991522ca7e64e$var$mainButton","addEventListener","contains","e","key"],"version":3,"file":"index.e494e7e9.js.map"}